{"remainingRequest":"E:\\Gua_new\\note-front\\node_modules\\babel-loader\\lib\\index.js!E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\Gua_new\\note-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Gua_new\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Gua_new\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue","mtime":1672662126355},{"path":"E:\\Gua_new\\note-front\\babel.config.js","mtime":1663921093000},{"path":"E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Gua_new\\note-front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Gua_new\\note-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBFZGl0b3IgZnJvbSAnLi9FZGl0b3IudnVlJzsKaW1wb3J0IHsgc2F2ZU5vdGVEYXRhIH0gZnJvbSAnQC9uZXR3b3JrL25vdGUvaW5kZXguanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRpdGxlOiAnJywKICAgICAgdGFnVmFsdWVzOiBbXSwKICAgICAgbm90ZUNvbnRlbnQ6ICcnLAogICAgICB0YWdPcHRpb25zOiBbJ0hUTUwnLCAnTXlTUUwnLCAnUEhQJywgJ0phdmEnLCAnUHl0aG9uJ10sCiAgICAgIHVwbG9hZFVybDogJycsCiAgICAgIGZpbGVMaXN0OiBbXSwKICAgICAgZmlsZU5hbWVNYXRjaDogWydqcGVnJywgJ2pwZycsICdwbmcnXQogICAgfTsKICB9LAoKICBjb21wb25lbnRzOiB7CiAgICBFZGl0b3IKICB9LAogIG1ldGhvZHM6IHsKICAgIC8qKgogICAgICog5a6e6ZmF5o+Q5Lqk5pWw5o2u5pa55rOVCiAgICAgKi8KICAgIGFzeW5jIHN1Ym1pdE5vdGVEYXRhKHBhcmFtKSB7CiAgICAgIHZhciBfdGhpcyQkcm91dGU7CgogICAgICBpZiAodGhpcy4kcmVmcy5lZGl0b3IuaXNOZWVkVXBsb2FkKCkpIHsKICAgICAgICAvLyDlpoLmnpznrJTorrDlhoXmnInlm77niYfvvIzpgqPkuYjlhYjov5vooYzlm77niYfkuIrkvKAKICAgICAgICBhd2FpdCB0aGlzLiRyZWZzLmVkaXRvci51cGxvYWRpbWcoKTsKICAgICAgfSAvLyDlr7nlpJrkuKp0YWfov5vooYzovazmjaLmlbDmja7moLzlvI8KCgogICAgICBjb25zdCB0YWdzID0gdGhpcy50YWdWYWx1ZXMuam9pbignLCcpOwogICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOyAvLyDlpoLmnpzlnLDlnYDmoI/kuIrmnIlncm91cElk77yM6K+B5piO5piv5YiG57uE5YaF5o+Q5Lqk55qECgogICAgICBjb25zdCBpZCA9IChfdGhpcyQkcm91dGUgPSB0aGlzLiRyb3V0ZSkgPT09IG51bGwgfHwgX3RoaXMkJHJvdXRlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyQkcm91dGUucXVlcnkuZ3JvdXBJZDsKICAgICAgaWYgKGlkKSBmb3JtRGF0YS5hcHBlbmQoJ2dyb3VwSWQnLCBpZCk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbm90ZUltZycsIHBhcmFtLmZpbGUpOwogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RpdGxlJywgdGhpcy50aXRsZSk7CiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnY29udGVudCcsIHRoaXMubm90ZUNvbnRlbnQpOwogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RhZycsIHRhZ3MpOwogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3VzZXJJZCcsIHRoaXMuJHN0b3JlLnN0YXRlLnVzZXJJbmZvLnVzZXJpZCk7CiAgICAgIHNhdmVOb3RlRGF0YShmb3JtRGF0YSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCdOb3RlIHBvc3RlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICBpZCA/IHRoaXMuJHJvdXRlci5wdXNoKGAvZ3JvdXA/aWQ9JHtpZH0mcGFnZT0xYCkgOiB0aGlzLiRyb3V0ZXIucHVzaCgnLycpOwogICAgICB9KTsKICAgIH0sCgogICAgdmFsaWRhdGVOb3RlSW5mbygpIHsKICAgICAgaWYgKHRoaXMudGl0bGUgPT0gJycgfHwgdGhpcy50YWdWYWx1ZXMubGVuZ3RoID09PSAwIHx8IHRoaXMubm90ZUNvbnRlbnQgPT0gJycgfHwgdGhpcy4kcmVmcy51cGxvYWQudXBsb2FkRmlsZXMubGVuZ3RoID09IDApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ1RoZSBpbmZvcm1hdGlvbiBpcyBub3QgY29tcGxldGUsIHBsZWFzZSBjaGVjaycpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAoKICAgIGhhbmRsZVN1Ym1pdE5vdGUoKSB7CiAgICAgIGlmICh0aGlzLnZhbGlkYXRlTm90ZUluZm8oKSkgewogICAgICAgIC8vIOiwg+eUqHVwbG9hZOe7hOS7tueahOS4iuS8oOaWueazle+8jOWcqOWug+WGhemDqOWBmuaPkOS6pAogICAgICAgIHRoaXMuJHJlZnMudXBsb2FkLnN1Ym1pdCgpOwogICAgICB9CiAgICB9LAoKICAgIGNoZWNrRmlsZShmaWxlKSB7CiAgICAgIC8v5LiK5Lyg5LmL5YmN55qE5pON5L2c77yMZmlsZeS4iuS8oOeahOaWh+S7tuWvueixoQogICAgICBsZXQgbmFtZSA9IGZpbGUubmFtZTsKCiAgICAgIGlmIChuYW1lLmxhc3RJbmRleE9mKCcuJykgPT0gLTEpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ2ZpbGUgZm9ybWF0IGlzIGluY29ycmVjdCcpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvL+iOt+WPluWQjue8gAogICAgICAgIGxldCBzdWZmID0gbmFtZS5zdWJzdHJpbmcobmFtZS5sYXN0SW5kZXhPZignLicpICsgMSk7CiAgICAgICAgdmFyIGNvdW50ID0gMDsgLy/pgY3ljobmj5DliY3lrprkuYnlpb3nmoTlkI7nvIDmlbDnu4QKCiAgICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLmZpbGVOYW1lTWF0Y2gpIHsKICAgICAgICAgIC8v5aaC5p6c5pyJ5Yy56YWN55qEKOazqOaEj+Wkp+Wwj+WGmemXrumimCkKICAgICAgICAgIGlmICh0aGlzLmZpbGVOYW1lTWF0Y2hbaV0udG9Mb3dlckNhc2UoKSA9PSBzdWZmLnRvTG93ZXJDYXNlKCkpIHsKICAgICAgICAgICAgY291bnQrKzsgLy/ljLnphY3liLDlsLHpgIDlh7rlvqrnjq8KCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQogICAgICAgIH0gLy/lpoLmnpzmsqHljLnphY3liLAKCgogICAgICAgIGlmIChjb3VudCA9PSAwKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ09ubHkgaW1hZ2VzIGluIGpwZywgcG5nLCBqcGVnIGZvcm1hdCBjYW4gYmUgdXBsb2FkZWQnKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0gLy/liKTmlq3mlofku7blpKflsI8KCgogICAgICBpZiAoZmlsZS5zaXplID4gMTAyNCAqIDEwMjQgKiAxMCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2Uud2FybmluZygnVGhlIGZpbGUgc2l6ZSBjYW5ub3QgZXhjZWVkIDEwTUInKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgfQp9Ow=="},{"version":3,"mappings":";AA8DA;AACA;AAEA;EACAA;IACA;MACAC,SADA;MAEAC,aAFA;MAGAC,eAHA;MAIAC,sDAJA;MAKAC,aALA;MAMAC,YANA;MAOAC;IAPA;EASA,CAXA;;EAYAC;IAAAC;EAAA,CAZA;EAaAC;IACA;AACA;AACA;IACA;MAAA;;MACA;QACA;QACA;MACA,CAJA,CAMA;;;MACA;MAEA,gCATA,CAWA;;MACA;MACA;MAEAC;MACAA;MACAA;MACAA;MACAA;MAEAC;QACA;QACAC,KACA,2CADA,GAEA,sBAFA;MAGA,CALA;IAMA,CA/BA;;IAgCAC;MACA,IACA,oBACA,2BADA,IAEA,sBAFA,IAGA,yCAJA,EAKA;QACA;QACA;MACA;;MACA;IACA,CA3CA;;IA4CAC;MACA;QACA;QACA;MACA;IACA,CAjDA;;IAkDAC;MACA;MACA;;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;QACA;QACA,cAHA,CAIA;;QACA;UACA;UACA;YACAC,QADA,CAEA;;YACA;UACA;QACA,CAZA,CAaA;;;QACA;UACA;UACA;QACA;MACA,CAxBA,CA0BA;;;MACA;QACA;QACA;MACA;IACA;;EAjFA;AAbA","names":["data","title","tagValues","noteContent","tagOptions","uploadUrl","fileList","fileNameMatch","components","Editor","methods","formData","saveNoteData","id","validateNoteInfo","handleSubmitNote","checkFile","count"],"sourceRoot":"src/views/submitNote/childrens","sources":["SubmitNoteContent.vue"],"sourcesContent":["<template>\n  <div class=\"submit-note-content\">\n    <div class=\"title\">\n      <span class=\"require\">Note Title </span>\n      <el-input\n        style=\"width: 350px\"\n        type=\"text\"\n        placeholder=\"please input note title\"\n        v-model=\"title\"\n        maxlength=\"20\"\n        show-word-limit\n      >\n      </el-input>\n    </div>\n\n    <div class=\"tag\">\n      <span class=\"require\">Note Tag </span>\n\n      <el-select\n        v-model=\"tagValues\"\n        multiple\n        placeholder=\"please select tag\"\n        style=\"width: 350px\"\n      >\n        <el-option v-for=\"item in tagOptions\" :key=\"item\" :value=\"item\">\n        </el-option>\n      </el-select>\n    </div>\n    <div class=\"content\">\n      <div class=\"content-title require\">Note Content</div>\n      <Editor v-model=\"noteContent\" ref=\"editor\" />\n    </div>\n\n    <div class=\"upload\">\n      <span class=\"require\">Note Image</span>\n      <el-upload\n        ref=\"upload\"\n        :action=\"uploadUrl\"\n        :file-list=\"fileList\"\n        :auto-upload=\"false\"\n        :before-upload=\"checkFile\"\n        accept=\".jpg,.png,.jpeg\"\n        :http-request=\"submitNoteData\"\n        :limit=\"1\"\n      >\n        <el-button size=\"small\" type=\"primary\">post note image</el-button>\n        <div slot=\"tip\" class=\"el-upload__tip\">\n          Only a single image in jpg/png/jpeg format can be uploaded and the\n          maximum size is 10MB\n        </div>\n      </el-upload>\n    </div>\n\n    <div class=\"submit\">\n      <el-button type=\"primary\" @click=\"handleSubmitNote\"\n        >submit note</el-button\n      >\n    </div>\n  </div>\n</template>\n\n<script>\nimport Editor from './Editor.vue'\nimport { saveNoteData } from '@/network/note/index.js'\n\nexport default {\n  data() {\n    return {\n      title: '',\n      tagValues: [],\n      noteContent: '',\n      tagOptions: ['HTML', 'MySQL', 'PHP', 'Java', 'Python'],\n      uploadUrl: '',\n      fileList: [],\n      fileNameMatch: ['jpeg', 'jpg', 'png']\n    }\n  },\n  components: { Editor },\n  methods: {\n    /**\n     * 实际提交数据方法\n     */\n    async submitNoteData(param) {\n      if (this.$refs.editor.isNeedUpload()) {\n        // 如果笔记内有图片，那么先进行图片上传\n        await this.$refs.editor.uploadimg()\n      }\n\n      // 对多个tag进行转换数据格式\n      const tags = this.tagValues.join(',')\n\n      const formData = new FormData()\n\n      // 如果地址栏上有groupId，证明是分组内提交的\n      const id = this.$route?.query.groupId\n      if (id) formData.append('groupId', id)\n\n      formData.append('noteImg', param.file)\n      formData.append('title', this.title)\n      formData.append('content', this.noteContent)\n      formData.append('tag', tags)\n      formData.append('userId', this.$store.state.userInfo.userid)\n\n      saveNoteData(formData).then(() => {\n        this.$message.success('Note posted successfully')\n        id\n          ? this.$router.push(`/group?id=${id}&page=1`)\n          : this.$router.push('/')\n      })\n    },\n    validateNoteInfo() {\n      if (\n        this.title == '' ||\n        this.tagValues.length === 0 ||\n        this.noteContent == '' ||\n        this.$refs.upload.uploadFiles.length == 0\n      ) {\n        this.$message.warning('The information is not complete, please check')\n        return false\n      }\n      return true\n    },\n    handleSubmitNote() {\n      if (this.validateNoteInfo()) {\n        // 调用upload组件的上传方法，在它内部做提交\n        this.$refs.upload.submit()\n      }\n    },\n    checkFile(file) {\n      //上传之前的操作，file上传的文件对象\n      let name = file.name\n      if (name.lastIndexOf('.') == -1) {\n        this.$message.warning('file format is incorrect')\n        return false\n      } else {\n        //获取后缀\n        let suff = name.substring(name.lastIndexOf('.') + 1)\n        var count = 0\n        //遍历提前定义好的后缀数组\n        for (var i in this.fileNameMatch) {\n          //如果有匹配的(注意大小写问题)\n          if (this.fileNameMatch[i].toLowerCase() == suff.toLowerCase()) {\n            count++\n            //匹配到就退出循环\n            break\n          }\n        }\n        //如果没匹配到\n        if (count == 0) {\n          this.$message.warning('Only images in jpg, png, jpeg format can be uploaded')\n          return false\n        }\n      }\n\n      //判断文件大小\n      if (file.size > 1024 * 1024 * 10) {\n        this.$message.warning('The file size cannot exceed 10MB')\n        return false\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.submit-note-content {\n  flex: 1;\n  background: #fff;\n  border-radius: 5px;\n  border: 1px solid #dcdcdc;\n  border-bottom: none;\n  padding: 10px;\n\n  .require {\n    &::before {\n      content: '*';\n      color: #f56c6c;\n      margin-right: 4px;\n    }\n  }\n\n  .title {\n    & > span {\n      margin-right: 20px;\n    }\n    margin-bottom: 15px;\n  }\n\n  .tag {\n    & > span {\n      margin-right: 24px;\n    }\n    margin-bottom: 15px;\n  }\n\n  .content {\n    .content-title {\n      margin-bottom: 10px;\n    }\n    margin-bottom: 15px;\n  }\n  .upload {\n    & > span {\n      margin-right: 24px;\n      margin-top: 5px;\n    }\n    display: flex;\n    align-items: flex-start;\n    margin-top: 5px;\n    height: 80px;\n    margin-bottom: 5px;\n  }\n\n  .submit {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n</style>\n"]}]}
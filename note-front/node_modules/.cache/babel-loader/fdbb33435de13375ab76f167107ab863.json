{"remainingRequest":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\babel-loader\\lib\\index.js!E:\\Notes_Sharing Study System\\note-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\Notes_Sharing Study System\\note-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Notes_Sharing Study System\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Notes_Sharing Study System\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue","mtime":1673166657636},{"path":"E:\\Notes_Sharing Study System\\note-front\\babel.config.js","mtime":1663921093000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBFZGl0b3IgZnJvbSAnLi9FZGl0b3IudnVlJzsKaW1wb3J0IHsgc2F2ZU5vdGVEYXRhIH0gZnJvbSAnQC9uZXR3b3JrL25vdGUvaW5kZXguanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRpdGxlOiAnJywKICAgICAgdGFnVmFsdWVzOiBbXSwKICAgICAgbm90ZUNvbnRlbnQ6ICcnLAogICAgICB0YWdPcHRpb25zOiBbJ0hUTUwnLCAnTXlTUUwnLCAnUEhQJywgJ0phdmEnLCAnUHl0aG9uJywgJ090aGVycyddLAogICAgICB1cGxvYWRVcmw6ICcnLAogICAgICBmaWxlTGlzdDogW10sCiAgICAgIGZpbGVOYW1lTWF0Y2g6IFsnanBlZycsICdqcGcnLCAncG5nJ10KICAgIH07CiAgfSwKCiAgY29tcG9uZW50czogewogICAgRWRpdG9yCiAgfSwKICBtZXRob2RzOiB7CiAgICAvKioKICAgICAqIOWunumZheaPkOS6pOaVsOaNruaWueazlQogICAgICovCiAgICBhc3luYyBzdWJtaXROb3RlRGF0YShwYXJhbSkgewogICAgICB2YXIgX3RoaXMkJHJvdXRlOwoKICAgICAgaWYgKHRoaXMuJHJlZnMuZWRpdG9yLmlzTmVlZFVwbG9hZCgpKSB7CiAgICAgICAgLy8g5aaC5p6c56yU6K6w5YaF5pyJ5Zu+54mH77yM6YKj5LmI5YWI6L+b6KGM5Zu+54mH5LiK5LygCiAgICAgICAgYXdhaXQgdGhpcy4kcmVmcy5lZGl0b3IudXBsb2FkaW1nKCk7CiAgICAgIH0gLy8g5a+55aSa5LiqdGFn6L+b6KGM6L2s5o2i5pWw5o2u5qC85byPCgoKICAgICAgY29uc3QgdGFncyA9IHRoaXMudGFnVmFsdWVzLmpvaW4oJywnKTsKICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsgLy8g5aaC5p6c5Zyw5Z2A5qCP5LiK5pyJZ3JvdXBJZO+8jOivgeaYjuaYr+WIhue7hOWGheaPkOS6pOeahAoKICAgICAgY29uc3QgaWQgPSAoX3RoaXMkJHJvdXRlID0gdGhpcy4kcm91dGUpID09PSBudWxsIHx8IF90aGlzJCRyb3V0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX3RoaXMkJHJvdXRlLnF1ZXJ5Lmdyb3VwSWQ7CiAgICAgIGlmIChpZCkgZm9ybURhdGEuYXBwZW5kKCdncm91cElkJywgaWQpOwogICAgICBmb3JtRGF0YS5hcHBlbmQoJ25vdGVJbWcnLCBwYXJhbS5maWxlKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCd0aXRsZScsIHRoaXMudGl0bGUpOwogICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NvbnRlbnQnLCB0aGlzLm5vdGVDb250ZW50KTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCd0YWcnLCB0YWdzKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCd1c2VySWQnLCB0aGlzLiRzdG9yZS5zdGF0ZS51c2VySW5mby51c2VyaWQpOwogICAgICBzYXZlTm90ZURhdGEoZm9ybURhdGEpLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcygnTm90ZSBwb3N0ZWQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgaWQgPyB0aGlzLiRyb3V0ZXIucHVzaChgL2dyb3VwP2lkPSR7aWR9JnBhZ2U9MWApIDogdGhpcy4kcm91dGVyLnB1c2goJy8nKTsKICAgICAgfSk7CiAgICB9LAoKICAgIHZhbGlkYXRlTm90ZUluZm8oKSB7CiAgICAgIGlmICh0aGlzLnRpdGxlID09ICcnIHx8IHRoaXMudGFnVmFsdWVzLmxlbmd0aCA9PT0gMCB8fCB0aGlzLm5vdGVDb250ZW50ID09ICcnIHx8IHRoaXMuJHJlZnMudXBsb2FkLnVwbG9hZEZpbGVzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCdUaGUgaW5mb3JtYXRpb24gaXMgbm90IGNvbXBsZXRlLCBwbGVhc2UgY2hlY2snKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfSwKCiAgICBoYW5kbGVTdWJtaXROb3RlKCkgewogICAgICBpZiAodGhpcy52YWxpZGF0ZU5vdGVJbmZvKCkpIHsKICAgICAgICAvLyDosIPnlKh1cGxvYWTnu4Tku7bnmoTkuIrkvKDmlrnms5XvvIzlnKjlroPlhoXpg6jlgZrmj5DkuqQKICAgICAgICB0aGlzLiRyZWZzLnVwbG9hZC5zdWJtaXQoKTsKICAgICAgfQogICAgfSwKCiAgICBjaGVja0ZpbGUoZmlsZSkgewogICAgICAvL+S4iuS8oOS5i+WJjeeahOaTjeS9nO+8jGZpbGXkuIrkvKDnmoTmlofku7blr7nosaEKICAgICAgbGV0IG5hbWUgPSBmaWxlLm5hbWU7CgogICAgICBpZiAobmFtZS5sYXN0SW5kZXhPZignLicpID09IC0xKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCdmaWxlIGZvcm1hdCBpcyBpbmNvcnJlY3QnKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy/ojrflj5blkI7nvIAKICAgICAgICBsZXQgc3VmZiA9IG5hbWUuc3Vic3RyaW5nKG5hbWUubGFzdEluZGV4T2YoJy4nKSArIDEpOwogICAgICAgIHZhciBjb3VudCA9IDA7IC8v6YGN5Y6G5o+Q5YmN5a6a5LmJ5aW955qE5ZCO57yA5pWw57uECgogICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5maWxlTmFtZU1hdGNoKSB7CiAgICAgICAgICAvL+WmguaenOacieWMuemFjeeahCjms6jmhI/lpKflsI/lhpnpl67popgpCiAgICAgICAgICBpZiAodGhpcy5maWxlTmFtZU1hdGNoW2ldLnRvTG93ZXJDYXNlKCkgPT0gc3VmZi50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICAgIGNvdW50Kys7IC8v5Yy56YWN5Yiw5bCx6YCA5Ye65b6q546vCgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9IC8v5aaC5p6c5rKh5Yy56YWN5YiwCgoKICAgICAgICBpZiAoY291bnQgPT0gMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCdPbmx5IGltYWdlcyBpbiBqcGcsIHBuZywganBlZyBmb3JtYXQgY2FuIGJlIHVwbG9hZGVkJyk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9IC8v5Yik5pat5paH5Lu25aSn5bCPCgoKICAgICAgaWYgKGZpbGUuc2l6ZSA+IDEwMjQgKiAxMDI0ICogMTApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ1RoZSBmaWxlIHNpemUgY2Fubm90IGV4Y2VlZCAxME1CJyk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogIH0KfTs="},{"version":3,"mappings":";AA8DA;AACA;AAEA;EACAA;IACA;MACAC,SADA;MAEAC,aAFA;MAGAC,eAHA;MAIAC,gEAJA;MAKAC,aALA;MAMAC,YANA;MAOAC;IAPA;EASA,CAXA;;EAYAC;IAAAC;EAAA,CAZA;EAaAC;IACA;AACA;AACA;IACA;MAAA;;MACA;QACA;QACA;MACA,CAJA,CAMA;;;MACA;MAEA,gCATA,CAWA;;MACA;MACA;MAEAC;MACAA;MACAA;MACAA;MACAA;MAEAC;QACA;QACAC,KACA,2CADA,GAEA,sBAFA;MAGA,CALA;IAMA,CA/BA;;IAgCAC;MACA,IACA,oBACA,2BADA,IAEA,sBAFA,IAGA,yCAJA,EAKA;QACA;QACA;MACA;;MACA;IACA,CA3CA;;IA4CAC;MACA;QACA;QACA;MACA;IACA,CAjDA;;IAkDAC;MACA;MACA;;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;QACA;QACA,cAHA,CAIA;;QACA;UACA;UACA;YACAC,QADA,CAEA;;YACA;UACA;QACA,CAZA,CAaA;;;QACA;UACA;UACA;QACA;MACA,CAxBA,CA0BA;;;MACA;QACA;QACA;MACA;IACA;;EAjFA;AAbA","names":["data","title","tagValues","noteContent","tagOptions","uploadUrl","fileList","fileNameMatch","components","Editor","methods","formData","saveNoteData","id","validateNoteInfo","handleSubmitNote","checkFile","count"],"sourceRoot":"src/views/submitNote/childrens","sources":["SubmitNoteContent.vue"],"sourcesContent":["<template>\n  <div class=\"submit-note-content\">\n    <div class=\"title\">\n      <span class=\"require\">Title </span>\n      <el-input\n        style=\"width: 350px\"\n        type=\"text\"\n        placeholder=\"please input note title\"\n        v-model=\"title\"\n        maxlength=\"20\"\n        show-word-limit\n      >\n      </el-input>\n    </div>\n\n    <div class=\"tag\">\n      <span class=\"require\">Keyword/Tag</span>\n\n      <el-select\n        v-model=\"tagValues\"\n        multiple\n        placeholder=\"please select Keyword/Tag\"\n        style=\"width: 350px\"\n      >\n        <el-option v-for=\"item in tagOptions\" :key=\"item\" :value=\"item\">\n        </el-option>\n      </el-select>\n    </div>\n    <div class=\"content\">\n      <div class=\"content-title require\">Content</div>\n      <Editor v-model=\"noteContent\" ref=\"editor\" />\n    </div>\n\n    <div class=\"upload\">\n      <span class=\"require\">Cover Image</span>\n      <el-upload\n        ref=\"upload\"\n        :action=\"uploadUrl\"\n        :file-list=\"fileList\"\n        :auto-upload=\"false\"\n        :before-upload=\"checkFile\"\n        accept=\".jpg,.png,.jpeg\"\n        :http-request=\"submitNoteData\"\n        :limit=\"1\"\n      >\n        <el-button size=\"small\" type=\"primary\">post note image</el-button>\n        <div slot=\"tip\" class=\"el-upload__tip\">\n          Only a single image in jpg/png/jpeg format can be uploaded and the\n          maximum size is 10MB\n        </div>\n      </el-upload>\n    </div>\n\n    <div class=\"submit\">\n      <el-button type=\"primary\" @click=\"handleSubmitNote\"\n        >submit note</el-button\n      >\n    </div>\n  </div>\n</template>\n\n<script>\nimport Editor from './Editor.vue'\nimport { saveNoteData } from '@/network/note/index.js'\n\nexport default {\n  data() {\n    return {\n      title: '',\n      tagValues: [],\n      noteContent: '',\n      tagOptions: ['HTML', 'MySQL', 'PHP', 'Java', 'Python','Others'],\n      uploadUrl: '',\n      fileList: [],\n      fileNameMatch: ['jpeg', 'jpg', 'png']\n    }\n  },\n  components: { Editor },\n  methods: {\n    /**\n     * 实际提交数据方法\n     */\n    async submitNoteData(param) {\n      if (this.$refs.editor.isNeedUpload()) {\n        // 如果笔记内有图片，那么先进行图片上传\n        await this.$refs.editor.uploadimg()\n      }\n\n      // 对多个tag进行转换数据格式\n      const tags = this.tagValues.join(',')\n\n      const formData = new FormData()\n\n      // 如果地址栏上有groupId，证明是分组内提交的\n      const id = this.$route?.query.groupId\n      if (id) formData.append('groupId', id)\n\n      formData.append('noteImg', param.file)\n      formData.append('title', this.title)\n      formData.append('content', this.noteContent)\n      formData.append('tag', tags)\n      formData.append('userId', this.$store.state.userInfo.userid)\n\n      saveNoteData(formData).then(() => {\n        this.$message.success('Note posted successfully')\n        id\n          ? this.$router.push(`/group?id=${id}&page=1`)\n          : this.$router.push('/')\n      })\n    },\n    validateNoteInfo() {\n      if (\n        this.title == '' ||\n        this.tagValues.length === 0 ||\n        this.noteContent == '' ||\n        this.$refs.upload.uploadFiles.length == 0\n      ) {\n        this.$message.warning('The information is not complete, please check')\n        return false\n      }\n      return true\n    },\n    handleSubmitNote() {\n      if (this.validateNoteInfo()) {\n        // 调用upload组件的上传方法，在它内部做提交\n        this.$refs.upload.submit()\n      }\n    },\n    checkFile(file) {\n      //上传之前的操作，file上传的文件对象\n      let name = file.name\n      if (name.lastIndexOf('.') == -1) {\n        this.$message.warning('file format is incorrect')\n        return false\n      } else {\n        //获取后缀\n        let suff = name.substring(name.lastIndexOf('.') + 1)\n        var count = 0\n        //遍历提前定义好的后缀数组\n        for (var i in this.fileNameMatch) {\n          //如果有匹配的(注意大小写问题)\n          if (this.fileNameMatch[i].toLowerCase() == suff.toLowerCase()) {\n            count++\n            //匹配到就退出循环\n            break\n          }\n        }\n        //如果没匹配到\n        if (count == 0) {\n          this.$message.warning('Only images in jpg, png, jpeg format can be uploaded')\n          return false\n        }\n      }\n\n      //判断文件大小\n      if (file.size > 1024 * 1024 * 10) {\n        this.$message.warning('The file size cannot exceed 10MB')\n        return false\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.submit-note-content {\n  flex: 1;\n  background: #fff;\n  border-radius: 5px;\n  border: 1px solid #dcdcdc;\n  border-bottom: none;\n  padding: 10px;\n\n  .require {\n    &::before {\n      /*content: '*';*/\n      color: #f56c6c;\n      margin-right: 4px;\n    }\n  }\n\n  .title {\n    & > span {\n      margin-right: 20px;\n    }\n    margin-bottom: 15px;\n  }\n\n  .tag {\n    & > span {\n      margin-right: 24px;\n    }\n    margin-bottom: 15px;\n  }\n\n  .content {\n    .content-title {\n      margin-bottom: 10px;\n    }\n    margin-bottom: 15px;\n  }\n  .upload {\n    & > span {\n      margin-right: 24px;\n      margin-top: 5px;\n    }\n    display: flex;\n    align-items: flex-start;\n    margin-top: 5px;\n    height: 80px;\n    margin-bottom: 5px;\n  }\n\n  .submit {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n</style>\n"]}]}
{"remainingRequest":"E:\\Gua_new\\note-front\\node_modules\\babel-loader\\lib\\index.js!E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\Gua_new\\note-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Gua_new\\note-front\\src\\views\\submitNote\\childrens\\Editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Gua_new\\note-front\\src\\views\\submitNote\\childrens\\Editor.vue","mtime":1672472342000},{"path":"E:\\Gua_new\\note-front\\babel.config.js","mtime":1663921093000},{"path":"E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Gua_new\\note-front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Gua_new\\note-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgc2F2ZU5vdGVDb250ZW50SW1hZ2UgfSBmcm9tICdAL25ldHdvcmsvbm90ZS9pbmRleC5qcyc7CmltcG9ydCBlZGl0b3JDb25mIGZyb20gJy4vZWRpdG9yQ29uZic7CmV4cG9ydCBkZWZhdWx0IHsKICBtb2RlbDogewogICAgcHJvcDogJ2NvbnRlbnQnLAogICAgZXZlbnQ6ICd1cGRhdGVDb250ZW50JwogIH0sCiAgcHJvcHM6IHsKICAgIGNvbnRlbnQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnJwogICAgfQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBlZGl0b3JWYWx1ZTogJycsCiAgICAgIGltZ0ZpbGVzOiB7fSwKICAgICAgZWRpdG9yQ29uZgogICAgfTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBoYW5kbGVJbWdBZGQocG9zLCBmaWxlKSB7CiAgICAgIHRoaXMuaW1nRmlsZXNbcG9zXSA9IGZpbGU7CiAgICB9LAoKICAgIGhhbmRsZUltZ0RlbChwb3MpIHsKICAgICAgZGVsZXRlIHRoaXMuaW1nRmlsZXNbcG9zXTsKICAgIH0sCgogICAgaXNOZWVkVXBsb2FkKCkgewogICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5pbWdGaWxlcykubGVuZ3RoICE9IDA7CiAgICB9LAoKICAgIHVwbG9hZGltZygpIHsKICAgICAgY29uc3QgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEoKTsKCiAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuaW1nRmlsZXMpIHsKICAgICAgICBmb3JtZGF0YS5hcHBlbmQoJ2ZpbGVzJywgdGhpcy5pbWdGaWxlc1trZXldLCBgJHtrZXl9LiR7dGhpcy5pbWdGaWxlc1trZXldLm5hbWUuc3BsaXQoJy4nKVsxXX1gKTsKICAgICAgfQogICAgICAvKioKICAgICAgICog6L+U5ZuecHJvbWlzZe+8jOWklumdoueUqGF3YWl06LCD55So77yM5L+d6K+B5LiK5Lyg5a6M5oiQ5LmL5ZCO77yM56yU6K6w5Lit55qE5Zu+54mH5Zyw5Z2A5bey57uP5o2i5oiQ5LqG5pyN5Yqh5Zmo55qE5Zyw5Z2ACiAgICAgICAqLwoKCiAgICAgIHJldHVybiBzYXZlTm90ZUNvbnRlbnRJbWFnZShmb3JtZGF0YSkudGhlbihyZXMgPT4gewogICAgICAgIC8qKgogICAgICAgICAqIHJlcy5kYXRhCiAgICAgICAgICogICAgMS5qcGc6IHVybAogICAgICAgICAqICAgIDIuanBnOiB1cmwKICAgICAgICAgKiAgICAuLi4KICAgICAgICAgKi8KICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiByZXMuZGF0YSkgewogICAgICAgICAgdGhpcy4kcmVmcy5tZC4kaW1nMlVybChrZXkuc3BsaXQoJy4nKVswXSwgcmVzLmRhdGFba2V5XSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfSk7CiAgICB9CgogIH0sCiAgd2F0Y2g6IHsKICAgIC8vIHYtbW9kZWwKICAgIGVkaXRvclZhbHVlKHZhbHVlKSB7CiAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZUNvbnRlbnQnLCB2YWx1ZSk7CiAgICB9CgogIH0KfTs="},{"version":3,"mappings":"AAaA;AACA;AAEA;EACAA;IACAC,eADA;IAEAC;EAFA,CADA;EAKAC;IACAC;MACAC,YADA;MAEAC;IAFA;EADA,CALA;;EAWAC;IACA;MACAC,eADA;MAEAC,YAFA;MAGAC;IAHA;EAKA,CAjBA;;EAkBAC;IACAC;MACA;IACA,CAHA;;IAIAC;MACA;IACA,CANA;;IAOAC;MACA;IACA,CATA;;IAUAC;MACA;;MACA;QACAC,gBACA,OADA,EAEA,kBAFA,EAGA,iDAHA;MAKA;MAEA;AACA;AACA;;;MACA;QACA;AACA;AACA;AACA;AACA;AACA;QACA;UACA;QACA;;QAEA;MACA,CAZA;IAaA;;EApCA,CAlBA;EAwDAC;IACA;IACAT;MACA;IACA;;EAJA;AAxDA","names":["model","prop","event","props","content","type","default","data","editorValue","imgFiles","editorConf","methods","handleImgAdd","handleImgDel","isNeedUpload","uploadimg","formdata","watch"],"sourceRoot":"src/views/submitNote/childrens","sources":["Editor.vue"],"sourcesContent":["<template>\n  <mavon-editor\n    id=\"editor\"\n    v-model=\"editorValue\"\n    :toolbars=\"editorConf\"\n    ref=\"md\"\n    @imgAdd=\"handleImgAdd\"\n    @imgDel=\"handleImgDel\"\n    language=\"en\"\n  ></mavon-editor>\n</template>\n\n<script>\nimport { saveNoteContentImage } from '@/network/note/index.js'\nimport editorConf from './editorConf'\n\nexport default {\n  model: {\n    prop: 'content',\n    event: 'updateContent'\n  },\n  props: {\n    content: {\n      type: String,\n      default: ''\n    }\n  },\n  data() {\n    return {\n      editorValue: '',\n      imgFiles: {},\n      editorConf\n    }\n  },\n  methods: {\n    handleImgAdd(pos, file) {\n      this.imgFiles[pos] = file\n    },\n    handleImgDel(pos) {\n      delete this.imgFiles[pos]\n    },\n    isNeedUpload() {\n      return Object.keys(this.imgFiles).length != 0\n    },\n    uploadimg() {\n      const formdata = new FormData()\n      for (const key in this.imgFiles) {\n        formdata.append(\n          'files',\n          this.imgFiles[key],\n          `${key}.${this.imgFiles[key].name.split('.')[1]}`\n        )\n      }\n\n      /**\n       * 返回promise，外面用await调用，保证上传完成之后，笔记中的图片地址已经换成了服务器的地址\n       */\n      return saveNoteContentImage(formdata).then((res) => {\n        /**\n         * res.data\n         *    1.jpg: url\n         *    2.jpg: url\n         *    ...\n         */\n        for (const key in res.data) {\n          this.$refs.md.$img2Url(key.split('.')[0], res.data[key])\n        }\n\n        return true\n      })\n    }\n  },\n  watch: {\n    // v-model\n    editorValue(value) {\n      this.$emit('updateContent', value)\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n#editor {\n  min-height: 400px;\n}\n</style>\n"]}]}
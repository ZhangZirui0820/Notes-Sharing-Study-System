{"remainingRequest":"E:\\Gua_new\\note-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Gua_new\\note-front\\src\\views\\submitNote\\childrens\\Editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Gua_new\\note-front\\src\\views\\submitNote\\childrens\\Editor.vue","mtime":1672472342000},{"path":"E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Gua_new\\note-front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Gua_new\\note-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IHNhdmVOb3RlQ29udGVudEltYWdlIH0gZnJvbSAnQC9uZXR3b3JrL25vdGUvaW5kZXguanMnCmltcG9ydCBlZGl0b3JDb25mIGZyb20gJy4vZWRpdG9yQ29uZicKCmV4cG9ydCBkZWZhdWx0IHsKICBtb2RlbDogewogICAgcHJvcDogJ2NvbnRlbnQnLAogICAgZXZlbnQ6ICd1cGRhdGVDb250ZW50JwogIH0sCiAgcHJvcHM6IHsKICAgIGNvbnRlbnQ6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnJwogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGVkaXRvclZhbHVlOiAnJywKICAgICAgaW1nRmlsZXM6IHt9LAogICAgICBlZGl0b3JDb25mCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBoYW5kbGVJbWdBZGQocG9zLCBmaWxlKSB7CiAgICAgIHRoaXMuaW1nRmlsZXNbcG9zXSA9IGZpbGUKICAgIH0sCiAgICBoYW5kbGVJbWdEZWwocG9zKSB7CiAgICAgIGRlbGV0ZSB0aGlzLmltZ0ZpbGVzW3Bvc10KICAgIH0sCiAgICBpc05lZWRVcGxvYWQoKSB7CiAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLmltZ0ZpbGVzKS5sZW5ndGggIT0gMAogICAgfSwKICAgIHVwbG9hZGltZygpIHsKICAgICAgY29uc3QgZm9ybWRhdGEgPSBuZXcgRm9ybURhdGEoKQogICAgICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLmltZ0ZpbGVzKSB7CiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKAogICAgICAgICAgJ2ZpbGVzJywKICAgICAgICAgIHRoaXMuaW1nRmlsZXNba2V5XSwKICAgICAgICAgIGAke2tleX0uJHt0aGlzLmltZ0ZpbGVzW2tleV0ubmFtZS5zcGxpdCgnLicpWzFdfWAKICAgICAgICApCiAgICAgIH0KCiAgICAgIC8qKgogICAgICAgKiDov5Tlm55wcm9taXNl77yM5aSW6Z2i55SoYXdhaXTosIPnlKjvvIzkv53or4HkuIrkvKDlrozmiJDkuYvlkI7vvIznrJTorrDkuK3nmoTlm77niYflnLDlnYDlt7Lnu4/mjaLmiJDkuobmnI3liqHlmajnmoTlnLDlnYAKICAgICAgICovCiAgICAgIHJldHVybiBzYXZlTm90ZUNvbnRlbnRJbWFnZShmb3JtZGF0YSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgLyoqCiAgICAgICAgICogcmVzLmRhdGEKICAgICAgICAgKiAgICAxLmpwZzogdXJsCiAgICAgICAgICogICAgMi5qcGc6IHVybAogICAgICAgICAqICAgIC4uLgogICAgICAgICAqLwogICAgICAgIGZvciAoY29uc3Qga2V5IGluIHJlcy5kYXRhKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLm1kLiRpbWcyVXJsKGtleS5zcGxpdCgnLicpWzBdLCByZXMuZGF0YVtrZXldKQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWUKICAgICAgfSkKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAvLyB2LW1vZGVsCiAgICBlZGl0b3JWYWx1ZSh2YWx1ZSkgewogICAgICB0aGlzLiRlbWl0KCd1cGRhdGVDb250ZW50JywgdmFsdWUpCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Editor.vue"],"names":[],"mappings":";AAaA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Editor.vue","sourceRoot":"src/views/submitNote/childrens","sourcesContent":["<template>\n  <mavon-editor\n    id=\"editor\"\n    v-model=\"editorValue\"\n    :toolbars=\"editorConf\"\n    ref=\"md\"\n    @imgAdd=\"handleImgAdd\"\n    @imgDel=\"handleImgDel\"\n    language=\"en\"\n  ></mavon-editor>\n</template>\n\n<script>\nimport { saveNoteContentImage } from '@/network/note/index.js'\nimport editorConf from './editorConf'\n\nexport default {\n  model: {\n    prop: 'content',\n    event: 'updateContent'\n  },\n  props: {\n    content: {\n      type: String,\n      default: ''\n    }\n  },\n  data() {\n    return {\n      editorValue: '',\n      imgFiles: {},\n      editorConf\n    }\n  },\n  methods: {\n    handleImgAdd(pos, file) {\n      this.imgFiles[pos] = file\n    },\n    handleImgDel(pos) {\n      delete this.imgFiles[pos]\n    },\n    isNeedUpload() {\n      return Object.keys(this.imgFiles).length != 0\n    },\n    uploadimg() {\n      const formdata = new FormData()\n      for (const key in this.imgFiles) {\n        formdata.append(\n          'files',\n          this.imgFiles[key],\n          `${key}.${this.imgFiles[key].name.split('.')[1]}`\n        )\n      }\n\n      /**\n       * 返回promise，外面用await调用，保证上传完成之后，笔记中的图片地址已经换成了服务器的地址\n       */\n      return saveNoteContentImage(formdata).then((res) => {\n        /**\n         * res.data\n         *    1.jpg: url\n         *    2.jpg: url\n         *    ...\n         */\n        for (const key in res.data) {\n          this.$refs.md.$img2Url(key.split('.')[0], res.data[key])\n        }\n\n        return true\n      })\n    }\n  },\n  watch: {\n    // v-model\n    editorValue(value) {\n      this.$emit('updateContent', value)\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n#editor {\n  min-height: 400px;\n}\n</style>\n"]}]}
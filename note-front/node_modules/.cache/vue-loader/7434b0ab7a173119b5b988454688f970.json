{"remainingRequest":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Notes_Sharing Study System\\note-front\\src\\views\\submitNote\\childrens\\Editor.vue?vue&type=style&index=0&id=536e2e43&lang=less&scoped=true&","dependencies":[{"path":"E:\\Notes_Sharing Study System\\note-front\\src\\views\\submitNote\\childrens\\Editor.vue","mtime":1672472342000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1655715156000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Notes_Sharing Study System\\note-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiNlZGl0b3IgewogIG1pbi1oZWlnaHQ6IDQwMHB4Owp9Cg=="},{"version":3,"sources":["Editor.vue"],"names":[],"mappings":";AAkFA;AACA;AACA","file":"Editor.vue","sourceRoot":"src/views/submitNote/childrens","sourcesContent":["<template>\n  <mavon-editor\n    id=\"editor\"\n    v-model=\"editorValue\"\n    :toolbars=\"editorConf\"\n    ref=\"md\"\n    @imgAdd=\"handleImgAdd\"\n    @imgDel=\"handleImgDel\"\n    language=\"en\"\n  ></mavon-editor>\n</template>\n\n<script>\nimport { saveNoteContentImage } from '@/network/note/index.js'\nimport editorConf from './editorConf'\n\nexport default {\n  model: {\n    prop: 'content',\n    event: 'updateContent'\n  },\n  props: {\n    content: {\n      type: String,\n      default: ''\n    }\n  },\n  data() {\n    return {\n      editorValue: '',\n      imgFiles: {},\n      editorConf\n    }\n  },\n  methods: {\n    handleImgAdd(pos, file) {\n      this.imgFiles[pos] = file\n    },\n    handleImgDel(pos) {\n      delete this.imgFiles[pos]\n    },\n    isNeedUpload() {\n      return Object.keys(this.imgFiles).length != 0\n    },\n    uploadimg() {\n      const formdata = new FormData()\n      for (const key in this.imgFiles) {\n        formdata.append(\n          'files',\n          this.imgFiles[key],\n          `${key}.${this.imgFiles[key].name.split('.')[1]}`\n        )\n      }\n\n      /**\n       * 返回promise，外面用await调用，保证上传完成之后，笔记中的图片地址已经换成了服务器的地址\n       */\n      return saveNoteContentImage(formdata).then((res) => {\n        /**\n         * res.data\n         *    1.jpg: url\n         *    2.jpg: url\n         *    ...\n         */\n        for (const key in res.data) {\n          this.$refs.md.$img2Url(key.split('.')[0], res.data[key])\n        }\n\n        return true\n      })\n    }\n  },\n  watch: {\n    // v-model\n    editorValue(value) {\n      this.$emit('updateContent', value)\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n#editor {\n  min-height: 400px;\n}\n</style>\n"]}]}
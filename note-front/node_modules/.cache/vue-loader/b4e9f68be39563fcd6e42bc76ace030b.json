{"remainingRequest":"E:\\Gua_new\\note-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\Gua_new\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\Gua_new\\note-front\\src\\views\\submitNote\\childrens\\SubmitNoteContent.vue","mtime":1672662126355},{"path":"E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Gua_new\\note-front\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\Gua_new\\note-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Gua_new\\note-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBFZGl0b3IgZnJvbSAnLi9FZGl0b3IudnVlJwppbXBvcnQgeyBzYXZlTm90ZURhdGEgfSBmcm9tICdAL25ldHdvcmsvbm90ZS9pbmRleC5qcycKCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGl0bGU6ICcnLAogICAgICB0YWdWYWx1ZXM6IFtdLAogICAgICBub3RlQ29udGVudDogJycsCiAgICAgIHRhZ09wdGlvbnM6IFsnSFRNTCcsICdNeVNRTCcsICdQSFAnLCAnSmF2YScsICdQeXRob24nXSwKICAgICAgdXBsb2FkVXJsOiAnJywKICAgICAgZmlsZUxpc3Q6IFtdLAogICAgICBmaWxlTmFtZU1hdGNoOiBbJ2pwZWcnLCAnanBnJywgJ3BuZyddCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7IEVkaXRvciB9LAogIG1ldGhvZHM6IHsKICAgIC8qKgogICAgICog5a6e6ZmF5o+Q5Lqk5pWw5o2u5pa55rOVCiAgICAgKi8KICAgIGFzeW5jIHN1Ym1pdE5vdGVEYXRhKHBhcmFtKSB7CiAgICAgIGlmICh0aGlzLiRyZWZzLmVkaXRvci5pc05lZWRVcGxvYWQoKSkgewogICAgICAgIC8vIOWmguaenOeslOiusOWGheacieWbvueJh++8jOmCo+S5iOWFiOi/m+ihjOWbvueJh+S4iuS8oAogICAgICAgIGF3YWl0IHRoaXMuJHJlZnMuZWRpdG9yLnVwbG9hZGltZygpCiAgICAgIH0KCiAgICAgIC8vIOWvueWkmuS4qnRhZ+i/m+ihjOi9rOaNouaVsOaNruagvOW8jwogICAgICBjb25zdCB0YWdzID0gdGhpcy50YWdWYWx1ZXMuam9pbignLCcpCgogICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpCgogICAgICAvLyDlpoLmnpzlnLDlnYDmoI/kuIrmnIlncm91cElk77yM6K+B5piO5piv5YiG57uE5YaF5o+Q5Lqk55qECiAgICAgIGNvbnN0IGlkID0gdGhpcy4kcm91dGU/LnF1ZXJ5Lmdyb3VwSWQKICAgICAgaWYgKGlkKSBmb3JtRGF0YS5hcHBlbmQoJ2dyb3VwSWQnLCBpZCkKCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbm90ZUltZycsIHBhcmFtLmZpbGUpCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndGl0bGUnLCB0aGlzLnRpdGxlKQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ2NvbnRlbnQnLCB0aGlzLm5vdGVDb250ZW50KQogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3RhZycsIHRhZ3MpCiAgICAgIGZvcm1EYXRhLmFwcGVuZCgndXNlcklkJywgdGhpcy4kc3RvcmUuc3RhdGUudXNlckluZm8udXNlcmlkKQoKICAgICAgc2F2ZU5vdGVEYXRhKGZvcm1EYXRhKS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ05vdGUgcG9zdGVkIHN1Y2Nlc3NmdWxseScpCiAgICAgICAgaWQKICAgICAgICAgID8gdGhpcy4kcm91dGVyLnB1c2goYC9ncm91cD9pZD0ke2lkfSZwYWdlPTFgKQogICAgICAgICAgOiB0aGlzLiRyb3V0ZXIucHVzaCgnLycpCiAgICAgIH0pCiAgICB9LAogICAgdmFsaWRhdGVOb3RlSW5mbygpIHsKICAgICAgaWYgKAogICAgICAgIHRoaXMudGl0bGUgPT0gJycgfHwKICAgICAgICB0aGlzLnRhZ1ZhbHVlcy5sZW5ndGggPT09IDAgfHwKICAgICAgICB0aGlzLm5vdGVDb250ZW50ID09ICcnIHx8CiAgICAgICAgdGhpcy4kcmVmcy51cGxvYWQudXBsb2FkRmlsZXMubGVuZ3RoID09IDAKICAgICAgKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCdUaGUgaW5mb3JtYXRpb24gaXMgbm90IGNvbXBsZXRlLCBwbGVhc2UgY2hlY2snKQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICAgIHJldHVybiB0cnVlCiAgICB9LAogICAgaGFuZGxlU3VibWl0Tm90ZSgpIHsKICAgICAgaWYgKHRoaXMudmFsaWRhdGVOb3RlSW5mbygpKSB7CiAgICAgICAgLy8g6LCD55SodXBsb2Fk57uE5Lu255qE5LiK5Lyg5pa55rOV77yM5Zyo5a6D5YaF6YOo5YGa5o+Q5LqkCiAgICAgICAgdGhpcy4kcmVmcy51cGxvYWQuc3VibWl0KCkKICAgICAgfQogICAgfSwKICAgIGNoZWNrRmlsZShmaWxlKSB7CiAgICAgIC8v5LiK5Lyg5LmL5YmN55qE5pON5L2c77yMZmlsZeS4iuS8oOeahOaWh+S7tuWvueixoQogICAgICBsZXQgbmFtZSA9IGZpbGUubmFtZQogICAgICBpZiAobmFtZS5sYXN0SW5kZXhPZignLicpID09IC0xKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCdmaWxlIGZvcm1hdCBpcyBpbmNvcnJlY3QnKQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9IGVsc2UgewogICAgICAgIC8v6I635Y+W5ZCO57yACiAgICAgICAgbGV0IHN1ZmYgPSBuYW1lLnN1YnN0cmluZyhuYW1lLmxhc3RJbmRleE9mKCcuJykgKyAxKQogICAgICAgIHZhciBjb3VudCA9IDAKICAgICAgICAvL+mBjeWOhuaPkOWJjeWumuS5ieWlveeahOWQjue8gOaVsOe7hAogICAgICAgIGZvciAodmFyIGkgaW4gdGhpcy5maWxlTmFtZU1hdGNoKSB7CiAgICAgICAgICAvL+WmguaenOacieWMuemFjeeahCjms6jmhI/lpKflsI/lhpnpl67popgpCiAgICAgICAgICBpZiAodGhpcy5maWxlTmFtZU1hdGNoW2ldLnRvTG93ZXJDYXNlKCkgPT0gc3VmZi50b0xvd2VyQ2FzZSgpKSB7CiAgICAgICAgICAgIGNvdW50KysKICAgICAgICAgICAgLy/ljLnphY3liLDlsLHpgIDlh7rlvqrnjq8KICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy/lpoLmnpzmsqHljLnphY3liLAKICAgICAgICBpZiAoY291bnQgPT0gMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKCdPbmx5IGltYWdlcyBpbiBqcGcsIHBuZywganBlZyBmb3JtYXQgY2FuIGJlIHVwbG9hZGVkJykKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfQoKICAgICAgLy/liKTmlq3mlofku7blpKflsI8KICAgICAgaWYgKGZpbGUuc2l6ZSA+IDEwMjQgKiAxMDI0ICogMTApIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLndhcm5pbmcoJ1RoZSBmaWxlIHNpemUgY2Fubm90IGV4Y2VlZCAxME1CJykKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgfQogIH0KfQo="},{"version":3,"sources":["SubmitNoteContent.vue"],"names":[],"mappings":";AA8DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SubmitNoteContent.vue","sourceRoot":"src/views/submitNote/childrens","sourcesContent":["<template>\n  <div class=\"submit-note-content\">\n    <div class=\"title\">\n      <span class=\"require\">Note Title </span>\n      <el-input\n        style=\"width: 350px\"\n        type=\"text\"\n        placeholder=\"please input note title\"\n        v-model=\"title\"\n        maxlength=\"20\"\n        show-word-limit\n      >\n      </el-input>\n    </div>\n\n    <div class=\"tag\">\n      <span class=\"require\">Note Tag </span>\n\n      <el-select\n        v-model=\"tagValues\"\n        multiple\n        placeholder=\"please select tag\"\n        style=\"width: 350px\"\n      >\n        <el-option v-for=\"item in tagOptions\" :key=\"item\" :value=\"item\">\n        </el-option>\n      </el-select>\n    </div>\n    <div class=\"content\">\n      <div class=\"content-title require\">Note Content</div>\n      <Editor v-model=\"noteContent\" ref=\"editor\" />\n    </div>\n\n    <div class=\"upload\">\n      <span class=\"require\">Note Image</span>\n      <el-upload\n        ref=\"upload\"\n        :action=\"uploadUrl\"\n        :file-list=\"fileList\"\n        :auto-upload=\"false\"\n        :before-upload=\"checkFile\"\n        accept=\".jpg,.png,.jpeg\"\n        :http-request=\"submitNoteData\"\n        :limit=\"1\"\n      >\n        <el-button size=\"small\" type=\"primary\">post note image</el-button>\n        <div slot=\"tip\" class=\"el-upload__tip\">\n          Only a single image in jpg/png/jpeg format can be uploaded and the\n          maximum size is 10MB\n        </div>\n      </el-upload>\n    </div>\n\n    <div class=\"submit\">\n      <el-button type=\"primary\" @click=\"handleSubmitNote\"\n        >submit note</el-button\n      >\n    </div>\n  </div>\n</template>\n\n<script>\nimport Editor from './Editor.vue'\nimport { saveNoteData } from '@/network/note/index.js'\n\nexport default {\n  data() {\n    return {\n      title: '',\n      tagValues: [],\n      noteContent: '',\n      tagOptions: ['HTML', 'MySQL', 'PHP', 'Java', 'Python'],\n      uploadUrl: '',\n      fileList: [],\n      fileNameMatch: ['jpeg', 'jpg', 'png']\n    }\n  },\n  components: { Editor },\n  methods: {\n    /**\n     * 实际提交数据方法\n     */\n    async submitNoteData(param) {\n      if (this.$refs.editor.isNeedUpload()) {\n        // 如果笔记内有图片，那么先进行图片上传\n        await this.$refs.editor.uploadimg()\n      }\n\n      // 对多个tag进行转换数据格式\n      const tags = this.tagValues.join(',')\n\n      const formData = new FormData()\n\n      // 如果地址栏上有groupId，证明是分组内提交的\n      const id = this.$route?.query.groupId\n      if (id) formData.append('groupId', id)\n\n      formData.append('noteImg', param.file)\n      formData.append('title', this.title)\n      formData.append('content', this.noteContent)\n      formData.append('tag', tags)\n      formData.append('userId', this.$store.state.userInfo.userid)\n\n      saveNoteData(formData).then(() => {\n        this.$message.success('Note posted successfully')\n        id\n          ? this.$router.push(`/group?id=${id}&page=1`)\n          : this.$router.push('/')\n      })\n    },\n    validateNoteInfo() {\n      if (\n        this.title == '' ||\n        this.tagValues.length === 0 ||\n        this.noteContent == '' ||\n        this.$refs.upload.uploadFiles.length == 0\n      ) {\n        this.$message.warning('The information is not complete, please check')\n        return false\n      }\n      return true\n    },\n    handleSubmitNote() {\n      if (this.validateNoteInfo()) {\n        // 调用upload组件的上传方法，在它内部做提交\n        this.$refs.upload.submit()\n      }\n    },\n    checkFile(file) {\n      //上传之前的操作，file上传的文件对象\n      let name = file.name\n      if (name.lastIndexOf('.') == -1) {\n        this.$message.warning('file format is incorrect')\n        return false\n      } else {\n        //获取后缀\n        let suff = name.substring(name.lastIndexOf('.') + 1)\n        var count = 0\n        //遍历提前定义好的后缀数组\n        for (var i in this.fileNameMatch) {\n          //如果有匹配的(注意大小写问题)\n          if (this.fileNameMatch[i].toLowerCase() == suff.toLowerCase()) {\n            count++\n            //匹配到就退出循环\n            break\n          }\n        }\n        //如果没匹配到\n        if (count == 0) {\n          this.$message.warning('Only images in jpg, png, jpeg format can be uploaded')\n          return false\n        }\n      }\n\n      //判断文件大小\n      if (file.size > 1024 * 1024 * 10) {\n        this.$message.warning('The file size cannot exceed 10MB')\n        return false\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.submit-note-content {\n  flex: 1;\n  background: #fff;\n  border-radius: 5px;\n  border: 1px solid #dcdcdc;\n  border-bottom: none;\n  padding: 10px;\n\n  .require {\n    &::before {\n      content: '*';\n      color: #f56c6c;\n      margin-right: 4px;\n    }\n  }\n\n  .title {\n    & > span {\n      margin-right: 20px;\n    }\n    margin-bottom: 15px;\n  }\n\n  .tag {\n    & > span {\n      margin-right: 24px;\n    }\n    margin-bottom: 15px;\n  }\n\n  .content {\n    .content-title {\n      margin-bottom: 10px;\n    }\n    margin-bottom: 15px;\n  }\n  .upload {\n    & > span {\n      margin-right: 24px;\n      margin-top: 5px;\n    }\n    display: flex;\n    align-items: flex-start;\n    margin-top: 5px;\n    height: 80px;\n    margin-bottom: 5px;\n  }\n\n  .submit {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n</style>\n"]}]}